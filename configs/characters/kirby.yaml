# Kirby Character Configuration
# =================================================================
# Configuration file for Kirby character media generation and social media posting.
# Defines generation types, workflows, prompts, styles, and platform settings.

# Character Identity
# -----------------------------------------------------------------
# Basic character identification settings
character:
  name: kirby  # Character identifier (lowercase, used for file naming)
  group_name: Kirby  # Character group (for multi-character scenarios)

# Generation Settings
# -----------------------------------------------------------------
# Controls media generation behavior, types, and quality thresholds
generation:
  output_dir: /app/output_media  # Directory where generated media files are saved

  # Generation Type Weights
  # Probability distribution for selecting generation method.
  # Values are relative weights (don't need to sum to 1.0).
  # Set to 0 to disable a type.
  generation_type_weights:
    text2img: 0          # Generate images directly from text (50% chance)
    image2image: 0          # Transform existing images (disabled)
    text2image2image: 0  # Two-stage: text→image→refined image (30% chance)
    text2video: 0          # Generate videos from text (disabled)
    text2image2video: 1  # Multi-stage: text→image→video with audio (20% chance)

  # Workflow Path Configuration
  # Maps each generation type to its ComfyUI workflow JSON file.
  # Workflows define the node graph for generation.
  workflows:
    text2img: /app/configs/workflow/nova-anime-xl.json         # Standard image generation
    text2video: /app/configs/workflow/wan2.1_t2v_audio.json   # Video generation with audio
    image2image: /app/configs/workflow/image_to_image.json    # Image transformation
    text2image2image: /app/configs/workflow/nova-anime-xl.json  # First stage workflow
    text2image2video: /app/configs/workflow/wan2.2_gguf_i2v_audio.json  # I2V workflow with audio

  # Quality Control
  # Minimum similarity score (0.0-1.0) between generated media and text description.
  # Media below this threshold is filtered out.
  similarity_threshold: 0.7

  # Prompt Generation Method Weights
  # Controls how text prompts are created.
  prompt_method_weights:
    arbitrary: 0.1  # Random creative scenarios (10% chance)
    news: 0.9       # Based on news articles (90% chance)

  # Image System Prompt Weights
  # Templates for formatting prompts to image generation models.
  # Each template optimizes for different visual styles or outcomes.
  image_system_prompt_weights:
    conceptual_logo_design_prompt: 0.1                            # Dark comedy scenarios
    stable_diffusion_prompt: 0.2                              # Standard SD optimization
    two_character_interaction_generate_system_prompt: 0.25    # Character interactions
    warm_scene_description_system_prompt: 0.2                 # Heartwarming scenes
    sticker_prompt_system_prompt: 0.25                        # Sticker/emoji style

  # Visual Style Weights
  # Artistic style guidance for image generation.
  # Empty string ("") allows the model to choose freely.
  style_weights:
    "minimalism style with pure background": 0.2
    "A highly saturated, dreamy-colored digital illustration style, utilizing soft volumetric lighting and meticulous detail rendering to portray dynamic/slice-of-life scenes of cute Chibi-style characters": 0.2
    "watercolor painting style with pure background": 0.10
    "sketch-like illustration with minimalist approach": 0.10
    "": 0.4  # No style guidance - LLM decides (40% chance)

# Social Media Configuration
# -----------------------------------------------------------------
# Settings for automated posting to social platforms
social_media:
  # Default hashtags appended to all posts
  default_hashtags:
    - カービィ       # Japanese: Kirby
    - 星のカービィ   # Japanese: Kirby of the Stars

  # Platform-Specific Settings
  # Each platform can be enabled/disabled and configured independently
  platforms:
    instagram:
      config_folder_path: /app/configs/social_media/credentials/kirby  # Credentials directory
      enabled: true  # Enable Instagram posting

    twitter:
      config_folder_path: /app/configs/social_media/credentials/kirby
      prefix: ""  # Text prefix for tweets (optional)
      enabled: true  # Enable Twitter posting

# Additional Generation Parameters
# -----------------------------------------------------------------
# Advanced settings controlling generation behavior and output quality
additional_params:
  is_negative: false  # Whether to use negative prompts (currently unused)

  # Image Generation Parameters
  image:
    images_per_description: 8  # Generate 8 images per text description

    # Custom Node Updates
    # Modify specific ComfyUI node parameters.
    # Useful for overriding workflow defaults.
    custom_node_updates:
      - node_type: "PrimitiveInt"
        inputs:
          value: 1024  # Set image resolution to 1024x1024

    # # Image-to-Image Strategy Parameters
    # # Used when generation_type is 'image2image'
    # images_per_input: 2  # Generate 2 variations per input image
    # denoise: 0.6         # Denoising strength (0.5-0.7, higher = more change)

    # Text-to-Image-to-Image Two-Stage Strategy
    # Used when generation_type is 'text2image2image'
    first_stage:
      images_per_description: 3  # First pass: create 4 base images per description

    second_stage:
      images_per_input: 4  # Second pass: create 4 refined versions per base image
      denoise: 0.7         # Refinement strength (higher = more artistic liberty)

    i2i_workflow_path: /app/configs/workflow/image_to_image.json  # Second stage workflow
    
    # Text-to-Image-to-Video: First Stage (Text-to-Image) Parameters
    # Used when generation_type is 'text2image2video'
    # T2I workflow path for first stage (optional, defaults to text2img workflow)
    t2i_workflow_path: /app/configs/workflow/nova-anime-xl.json

  # Text-to-Image-to-Video Strategy Parameters
  # Used when generation_type is 'text2image2video'
  video:
    # I2V workflow path (defaults to text2image2video workflow if not specified)
    i2v_workflow_path: /app/configs/workflow/wan2.2_gguf_i2v_audio.json
    videos_per_image: 2  # Generate 1 video per filtered image
    
    # Custom Node Updates for I2V workflow
    # These updates are applied to the I2V workflow nodes
    custom_node_updates: []
